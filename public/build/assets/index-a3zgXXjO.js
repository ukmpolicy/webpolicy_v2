import{m as G,r as c,j as e,U as K,K as O,L as $}from"./app-Dc9BPJ51.js";import{L as w,I as N,a as y}from"./label-DmTmK6Hu.js";import{B as D}from"./app-logo-icon-CH0ORW6l.js";import{C as q}from"./checkbox-BPX09xiM.js";import{D as U,a as J,b as Q,c as W,d as X}from"./dialog-CRKhoLbo.js";import{t as p,L as Y,D as Z,a as ee,b as ae,c as F,A as se}from"./app-layout-CcgGL9Sd.js";import{u as te,S as ne,a as E,b as L,c as R,d as z,e as A,L as re,T as ie,f as le,g as I,h as oe,i as B,j as de,k as H,P as ce,l as he,m as S,n as ge,o as me,p as xe,q as ue,A as pe,r as je,s as fe,t as be,v as ve,w as Ce,x as Pe,y as _e,z as ke,B as we,C as Se,D as Ne,E as De,F as Te,G as ye,H as Ae}from"./table-BdddCSuh.js";import{T as Ie}from"./tag-Bi65NHqP.js";/* empty css            */import"./index-NRfi-MUJ.js";import"./index-R-_rSz3o.js";import"./index-DKzscMMm.js";function Me({open:u,onClose:h,initialData:r}){var k;const g=!!(r!=null&&r.id),{data:t,setData:o,post:j,put:f,processing:x,errors:i,reset:b}=G({name:"",started_at:"",ended_at:"",is_active:!1,...r});c.useEffect(()=>{r&&Object.entries(r).forEach(([l,v])=>{o(l,v)})},[r,o]);function P(l){if(l.preventDefault(),!t.started_at||!t.ended_at){p.error("Tanggal mulai dan berakhir harus diisi");return}const v=new Date(t.started_at),m=new Date(t.ended_at);if(v>m){p.error("Tanggal mulai tidak boleh lebih besar dari tanggal selesai");return}g?f(`/periods/${r.id}`,{data:t,onSuccess:()=>{p.success("Periode berhasil diubah!"),h(),b()},onError:()=>{p.error("Gagal mengubah periode.")}}):j("/periods",{data:t,onSuccess:()=>{p.success("Periode berhasil ditambahkan!"),h(),b()},onError:()=>{p.error("Gagal menambahkan periode.")}})}return e.jsx(U,{open:u,onOpenChange:h,children:e.jsxs(J,{children:[e.jsx(Q,{children:g?"Edit Periode":"Tambah Periode"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(w,{children:"Nama Periode"}),e.jsx(N,{value:t.name,onChange:l=>o("name",l.target.value),placeholder:"Contoh: 2024-2025",required:!0}),e.jsx(y,{message:i.name})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Tanggal Mulai"}),e.jsx(N,{type:"date",value:t.started_at.split(" ")[0],onChange:l=>o("started_at",l.target.value)}),e.jsx(y,{message:i.started_at||i.ended_at})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Tanggal Berakhir"}),e.jsx(N,{type:"date",value:((k=t.ended_at)==null?void 0:k.split(" ")[0])||"",onChange:l=>o("ended_at",l.target.value)}),e.jsx(y,{message:i.ended_at})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"is_active",checked:t.is_active,onCheckedChange:l=>o("is_active",l)}),e.jsxs(w,{htmlFor:"is_active",children:["Status: ",t.is_active?"Aktif":"Tidak Aktif"]})]}),e.jsxs(W,{children:[e.jsx(X,{asChild:!0,children:e.jsx(D,{type:"button",variant:"secondary",onClick:h,children:"Batal"})}),e.jsx(D,{type:"submit",disabled:x,children:g?"Simpan Perubahan":"Simpan"})]})]})]})})}function Fe({data:u,onEdit:h}){var M;const[r,g]=c.useState(null),[t,o]=c.useState(""),[j,f]=c.useState([]),[x,i]=c.useState(10),[b,P]=c.useState(0);c.useEffect(()=>{P(0)},[t,j]);const k=c.useMemo(()=>Array.from(new Set(u.map(a=>a.name))),[u]),l=((M=j.find(a=>a.id==="name"))==null?void 0:M.value)??"",v=[{id:"rowNumber",header:"#",cell:({row:a})=>a.index+1+b*x},{accessorKey:"name",header:"Nama Periode",cell:a=>a.getValue(),filterFn:(a,s,n)=>!n||n==="__all__"?!0:a.getValue(s)===n},{accessorKey:"started_at",header:"Tanggal Mulai",cell:a=>new Date(a.getValue()).toLocaleDateString("id-ID")},{accessorKey:"ended_at",header:"Tanggal Selesai",cell:a=>new Date(a.getValue()).toLocaleDateString("id-ID")},{accessorKey:"is_active",header:"Status Aktif",cell:a=>e.jsx("span",{className:`text-bold ${a.getValue()?"text-green-500":"text-red-500"}`,children:a.getValue()?"Aktif":"Tidak Aktif"})},{id:"actions",header:"Aksi",cell:({row:a})=>e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(D,{size:"icon",variant:"ghost","aria-label":"Aksi",children:e.jsx(De,{className:"h-4 w-4"})})}),e.jsxs(ae,{children:[e.jsxs(F,{onClick:()=>h==null?void 0:h(a.original),children:[e.jsx(Te,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(F,{variant:"destructive",onClick:()=>g(a.original.id),children:[e.jsx(ye,{className:"mr-2 h-4 w-4"})," Hapus"]})]})]})}],m=te({data:u,columns:v,state:{globalFilter:t,columnFilters:j,pagination:{pageIndex:b,pageSize:x}},onGlobalFilterChange:o,onColumnFiltersChange:f,onPaginationChange:a=>{if(typeof a=="function"){const s=a({pageIndex:b,pageSize:x});P(s.pageIndex),i(s.pageSize)}else P(a.pageIndex),i(a.pageSize)},getCoreRowModel:Ne(),getFilteredRowModel:Se(),getPaginationRowModel:we()}),T=m.getPageCount(),C=m.getState().pagination.pageIndex;function V(a,s){let d=[];for(let _=Math.max(0,a-2);_<=Math.min(s-1,a+2);_++)d.push(_);return d[0]>0&&(d=[0,...d]),d[d.length-1]<s-1&&(d=[...d,s-1]),Array.from(new Set(d))}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative w-48",children:[e.jsx(N,{type:"search",placeholder:"Cari Periode...",value:t,onChange:a=>o(a.target.value),className:"pl-9"}),e.jsx(ne,{className:"text-muted-foreground pointer-events-none absolute top-1/2 left-2 h-4 w-4 -translate-y-1/2"})]}),e.jsxs(E,{value:l||"__all__",onValueChange:a=>f(s=>[...s.filter(n=>n.id!=="name"),a!=="__all__"?{id:"name",value:a}:void 0].filter(Boolean)),children:[e.jsx(L,{className:"w-40",children:e.jsx(R,{placeholder:"Semua Periode"})}),e.jsxs(z,{children:[e.jsxs(A,{value:"__all__",children:[e.jsx(Y,{className:"mr-2 inline h-4 w-4"})," Semua Periode"]}),k.map(a=>e.jsxs(A,{value:a,children:[e.jsx(Ie,{className:"mr-2 inline h-4 w-4"}),a]},a))]})]}),e.jsxs(E,{value:String(x),onValueChange:a=>i(Number(a)),children:[e.jsx(L,{className:"w-32",children:e.jsx(R,{})}),e.jsx(z,{children:[5,10,20,50].map(a=>e.jsxs(A,{value:String(a),children:[e.jsx(re,{className:"mr-2 inline h-4 w-4"}),a]},a))})]})]}),e.jsxs(ie,{className:"divide-muted divide-y overflow-hidden rounded-lg border",children:[e.jsx(le,{children:m.getHeaderGroups().map(a=>e.jsx(I,{className:"bg-muted dark:bg-zinc-900",children:a.headers.map(s=>e.jsx(oe,{className:"font-bold",children:B(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(de,{children:m.getRowModel().rows.length===0?e.jsx(I,{children:e.jsx(H,{colSpan:v.length,className:"text-center",children:"Tidak ada data."})}):m.getRowModel().rows.map((a,s)=>e.jsx(I,{className:s%2===0?"bg-white dark:bg-zinc-900":"bg-gray-50 dark:bg-zinc-800",children:a.getVisibleCells().map(n=>e.jsx(H,{className:"border-r border-l dark:border-zinc-800 dark:text-zinc-100",children:B(n.column.columnDef.cell,n.getContext())},n.id))},a.id))})]}),e.jsx(ce,{className:"mt-4",children:e.jsxs(he,{children:[e.jsx(S,{children:e.jsx(ge,{onClick:a=>{a.preventDefault(),C>0&&m.previousPage()},href:"#","aria-disabled":C===0})}),(()=>{const a=V(C,T);let s=-1;return a.map(n=>{const d=s!==-1&&n-s>1;return s=n,e.jsxs(K.Fragment,{children:[d&&e.jsx(S,{children:e.jsx(me,{})}),e.jsx(S,{children:e.jsx(xe,{isActive:n===C,onClick:_=>{_.preventDefault(),m.setPageIndex(n)},href:"#",children:n+1})})]},n)})})(),e.jsx(S,{children:e.jsx(ue,{onClick:a=>{a.preventDefault(),C<T-1&&m.nextPage()},href:"#","aria-disabled":C===T-1})})]})}),e.jsx(pe,{open:!!r,onOpenChange:()=>g(null),children:e.jsxs(je,{children:[e.jsxs(fe,{children:[e.jsx(be,{children:"Hapus Periode?"}),e.jsx(ve,{children:"Apakah Anda yakin ingin menghapus periode ini? Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(Ce,{children:[e.jsx(Pe,{onClick:()=>g(null),children:"Batal"}),e.jsx(_e,{onClick:()=>{r&&(ke.Inertia.delete(`/periods/${r}`,{onSuccess:()=>p.success("Periode berhasil dihapus!"),onError:()=>p.error("Gagal menghapus periode.")}),g(null))},children:"Hapus"})]})]})})]})}function Ue(){const{periods:u=[]}=O().props,[h,r]=c.useState(!1),[g,t]=c.useState(null),[o,j]=c.useState(""),f=u.filter(i=>i.name.toLowerCase().includes(o.toLowerCase())),x=u.find(i=>i.is_active);return e.jsxs(se,{breadcrumbs:[{title:"Periods",href:"/periods"}],children:[e.jsx($,{title:"Periods"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Periode List"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(D,{onClick:()=>{t(null),r(!0)},children:[e.jsx(Ae,{className:"m-auto w-4"})," Tambah Periode"]})})]}),x&&e.jsxs("div",{className:"font-semibold text-green-600",children:["Periode aktif saat ini: ",e.jsx("strong",{children:x.name})]}),e.jsx(Fe,{data:f,onEdit:i=>{t(i),r(!0)}}),e.jsx(Me,{open:h,onClose:()=>{r(!1),t(null)},initialData:g||{name:"",started_year:"",ended_year:"",is_active:!1}})]})]})}export{Ue as default};
