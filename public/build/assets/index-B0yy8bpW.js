import{r,j as e,U as Q,m as B,K as W,L as X}from"./app-Dc9BPJ51.js";import{L as Y,t as C,D as Z,a as ee,b as se,c as D,A as ae}from"./app-layout-CcgGL9Sd.js";import{u as ne,S as le,a as F,b as I,c as M,d as E,e as y,L as te,T as re,f as ie,g as P,h as oe,i as _,j as ce,k as L,P as de,l as me,m as N,n as ue,o as he,p as xe,q as ge,A as pe,r as je,s as fe,t as be,v as Ce,w as Se,x as ve,y as we,z as H,B as Ne,C as Re,D as ke,E as De,F as ye,G as Pe,H as Te}from"./table-BdddCSuh.js";import{B as v}from"./app-logo-icon-CH0ORW6l.js";import{I as G,L as Ae,a as Fe}from"./label-DmTmK6Hu.js";import{T as z}from"./tag-Bi65NHqP.js";import{C as Ie}from"./calendar-days-DBlI59LZ.js";import{D as O,a as V,b as K,c as $,d as q}from"./dialog-CRKhoLbo.js";import{C as Me}from"./checkbox-BPX09xiM.js";/* empty css            */import"./index-NRfi-MUJ.js";import"./index-R-_rSz3o.js";import"./index-DKzscMMm.js";function Ee({data:x,onEdit:i,onManagePermissions:a}){var A;const[c,d]=r.useState(null),[o,j]=r.useState(""),[m,f]=r.useState([]),[g,p]=r.useState(10),[n,u]=r.useState(0);r.useEffect(()=>{u(0)},[o,m]);const R=r.useMemo(()=>Array.from(new Set(x.map(s=>s.name))),[x]),U=((A=m.find(s=>s.id==="name"))==null?void 0:A.value)??"",T=[{accessorKey:"id",header:"#",cell:s=>s.getValue()},{accessorKey:"name",header:"Nama Role",cell:s=>s.getValue(),filterFn:(s,l,t)=>!t||t==="__all__"?!0:s.getValue(l)===t},{accessorKey:"created_at",header:()=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"w-4 h-4"})," Dibuat"]}),cell:s=>new Date(s.getValue()).toLocaleDateString("id-ID")},{id:"actions",header:"Aksi",cell:({row:s})=>e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(v,{size:"icon",variant:"ghost","aria-label":"Aksi",children:e.jsx(De,{className:"w-4 h-4"})})}),e.jsxs(se,{children:[e.jsxs(D,{onClick:()=>i==null?void 0:i(s.original),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(D,{onClick:()=>a==null?void 0:a(s.original),children:[e.jsx(z,{className:"w-4 h-4 mr-2"})," Manage Permissions"]}),e.jsxs(D,{variant:"destructive",onClick:()=>d(s.original.id),children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"})," Hapus"]})]})]})}],b=ne({data:x,columns:T,state:{globalFilter:o,columnFilters:m,pagination:{pageIndex:n,pageSize:g}},onGlobalFilterChange:j,onColumnFiltersChange:f,onPaginationChange:s=>{if(typeof s=="function"){const l=s({pageIndex:n,pageSize:g});u(l.pageIndex),p(l.pageSize)}else u(s.pageIndex),p(s.pageSize)},getCoreRowModel:ke(),getFilteredRowModel:Re(),getPaginationRowModel:Ne()}),k=b.getPageCount(),S=b.getState().pagination.pageIndex;function J(s,l){let h=[];for(let w=Math.max(0,s-2);w<=Math.min(l-1,s+2);w++)h.push(w);return h[0]>0&&(h=[0,...h]),h[h.length-1]<l-1&&(h=[...h,l-1]),Array.from(new Set(h))}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4 items-center",children:[e.jsxs("div",{className:"relative w-48",children:[e.jsx(G,{type:"search",placeholder:"Cari role...",value:o,onChange:s=>j(s.target.value),className:"pl-9"}),e.jsx(le,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"})]}),e.jsxs(F,{value:U||"__all__",onValueChange:s=>f(l=>[...l.filter(t=>t.id!=="name"),s!=="__all__"?{id:"name",value:s}:void 0].filter(Boolean)),children:[e.jsx(I,{className:"w-40",children:e.jsx(M,{placeholder:"Semua Role"})}),e.jsxs(E,{children:[e.jsxs(y,{value:"__all__",children:[e.jsx(Y,{className:"w-4 h-4 mr-2 inline"})," Semua Role"]}),R.map(s=>e.jsxs(y,{value:s,children:[e.jsx(z,{className:"w-4 h-4 mr-2 inline"}),s]},s))]})]}),e.jsxs(F,{value:String(g),onValueChange:s=>p(Number(s)),children:[e.jsx(I,{className:"w-32",children:e.jsx(M,{})}),e.jsx(E,{children:[5,10,20,50].map(s=>e.jsxs(y,{value:String(s),children:[e.jsx(te,{className:"w-4 h-4 mr-2 inline"}),s]},s))})]})]}),e.jsxs(re,{className:"border rounded-lg overflow-hidden divide-y divide-muted",children:[e.jsx(ie,{children:b.getHeaderGroups().map(s=>e.jsx(P,{className:"bg-muted dark:bg-zinc-900",children:s.headers.map(l=>e.jsx(oe,{className:"font-bold",children:_(l.column.columnDef.header,l.getContext())},l.id))},s.id))}),e.jsx(ce,{children:b.getRowModel().rows.length===0?e.jsx(P,{children:e.jsx(L,{colSpan:T.length,className:"text-center",children:"Tidak ada data."})}):b.getRowModel().rows.map((s,l)=>e.jsx(P,{className:l%2===0?"bg-white dark:bg-zinc-900":"bg-gray-50 dark:bg-zinc-800",children:s.getVisibleCells().map(t=>e.jsx(L,{className:"border-l border-r dark:border-zinc-800 dark:text-zinc-100",children:_(t.column.columnDef.cell,t.getContext())},t.id))},s.id))})]}),e.jsx(de,{className:"mt-4",children:e.jsxs(me,{children:[e.jsx(N,{children:e.jsx(ue,{onClick:s=>{s.preventDefault(),S>0&&b.previousPage()},href:"#","aria-disabled":S===0})}),(()=>{const s=J(S,k);let l=-1;return s.map(t=>{const h=l!==-1&&t-l>1;return l=t,e.jsxs(Q.Fragment,{children:[h&&e.jsx(N,{children:e.jsx(he,{})}),e.jsx(N,{children:e.jsx(xe,{isActive:t===S,onClick:w=>{w.preventDefault(),b.setPageIndex(t)},href:"#",children:t+1})})]},t)})})(),e.jsx(N,{children:e.jsx(ge,{onClick:s=>{s.preventDefault(),S<k-1&&b.nextPage()},href:"#","aria-disabled":S===k-1})})]})}),e.jsx(pe,{open:!!c,onOpenChange:()=>d(null),children:e.jsxs(je,{children:[e.jsxs(fe,{children:[e.jsx(be,{children:"Hapus Role?"}),e.jsx(Ce,{children:"Apakah Anda yakin ingin menghapus role ini? Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(Se,{children:[e.jsx(ve,{onClick:()=>d(null),children:"Batal"}),e.jsx(we,{onClick:()=>{c&&(H.Inertia.delete(`/roles/${c}`,{onSuccess:()=>C.success("Role berhasil dihapus!"),onError:()=>C.error("Gagal menghapus role.")}),d(null))},children:"Hapus"})]})]})})]})}function _e({open:x,onClose:i,initialData:a}){const c=!!(a!=null&&a.id),{data:d,setData:o,post:j,put:m,processing:f,errors:g,reset:p}=B(a||{name:""});r.useEffect(()=>{o(a||{name:""})},[a,o]);function n(u){u.preventDefault(),c?m(`/roles/${a.id}`,{onSuccess:()=>{C.success("Role berhasil diubah!"),i(),p()},onError:()=>{C.error("Gagal mengubah role.")}}):j("/roles",{onSuccess:()=>{C.success("Role berhasil ditambahkan!"),i(),p()},onError:()=>{C.error("Gagal menambah role.")}})}return e.jsx(O,{open:x,onOpenChange:i,children:e.jsxs(V,{children:[e.jsx(K,{children:c?"Edit Role":"Tambah Role"}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ae,{htmlFor:"name",children:"Nama Role"}),e.jsx(G,{id:"name",value:d.name,onChange:u=>o("name",u.target.value),autoFocus:!0}),e.jsx(Fe,{message:g.name})]}),e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(v,{type:"button",variant:"secondary",onClick:i,children:"Batal"})}),e.jsx(v,{type:"submit",disabled:f,children:c?"Simpan Perubahan":"Simpan"})]})]})]})})}function Le({open:x,onClose:i,role:a,allPermissions:c}){const[d,o]=r.useState([]);r.useEffect(()=>{a!=null&&a.permissions?o(a.permissions.map(n=>n.id)):o([])},[a]);const{setData:j,post:m,processing:f}=B({permissions:[]});r.useEffect(()=>j("permissions",d),[d,j]);function g(n){o(u=>u.includes(n)?u.filter(R=>R!==n):[...u,n])}function p(n){n.preventDefault(),m(`/roles/${a==null?void 0:a.id}/permissions`,{onSuccess:()=>{C.success("Permissions updated!"),i(),H.Inertia.reload({only:["roles"]})},onError:()=>C.error("Gagal update permissions"),preserveScroll:!0})}return e.jsx(O,{open:x,onOpenChange:i,children:e.jsxs(V,{children:[e.jsxs(K,{children:["Manage Permissions for ",a==null?void 0:a.name]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:c.map(n=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx(Me,{checked:d.includes(n.id),onCheckedChange:()=>g(n.id)}),e.jsx("span",{children:n.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n.key,")"]})]},n.id))}),e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(v,{type:"button",variant:"secondary",onClick:i,children:"Batal"})}),e.jsx(v,{type:"submit",disabled:f,children:"Simpan"})]})]})]})})}function Xe(){const{roles:x=[],permissions:i=[]}=W().props,[a,c]=r.useState(!1),[d,o]=r.useState(!1),[j,m]=r.useState(null),[f,g]=r.useState(null),p=x.find(n=>n.id===f)||null;return e.jsxs(ae,{breadcrumbs:[{title:"Role",href:"/roles"}],children:[e.jsx(X,{title:"Role"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Role List"}),e.jsxs(v,{onClick:()=>{m(null),c(!0)},children:[e.jsx(Te,{className:"w-4 m-auto"})," Tambah Role"]})]}),e.jsx(Ee,{data:x,onEdit:n=>{m(n),c(!0)},onManagePermissions:n=>{g(n.id),o(!0)}}),e.jsx(_e,{open:a,onClose:()=>{c(!1),m(null)},initialData:j||{name:""}}),e.jsx(Le,{open:d,onClose:()=>{o(!1),g(null)},role:p,allPermissions:i})]})]})}export{Xe as default};
